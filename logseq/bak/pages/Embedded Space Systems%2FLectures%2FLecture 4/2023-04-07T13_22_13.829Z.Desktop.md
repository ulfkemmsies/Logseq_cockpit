- Concurrency
	- In computer science, concurrency is a property of systems in which several computations are executing simultaneously, and potentially interacting with each other.
	  id:: 6424aa4b-68cb-426a-9be6-664a65e117df
	- A process is a unit of execution in concurrent programming.
	- Thread is an execution unit that is part of a process. A process can have multiple threads.
	- Multithreading is a technique which allows a CPU to execute many tasks of one process at the same time. These threads can execute individually while sharing their resources.
	  ![image.png](../assets/image_1680092759335_0.png)
	- Microcontroller Unit HW & SW for Concurrency
		- CPU executes instructions from one or more thread of execution
		- Hardware peripherals add dedicated concurrent processing, some examples being
			- Watchdog timer
			- ADC
			- Timers
			- Communications with other devices
			- Detecting external signal events
			- Power management
		- Peripherals use interrupts to notify CPU of events
	- Simple systems are usually designed as foreground-background or super-loops. Foreground is also called interrupt level; background is called task level.
	- [[GPT Generated Flashcards]]
	  collapsed:: true
		- {{cloze Concurrency}} is the property of systems in which multiple computations are executing simultaneously and potentially interacting with each other.
		  card-last-interval:: 4
		  card-repeats:: 1
		  card-ease-factor:: 2.36
		  card-next-schedule:: 2023-04-07T06:06:01.303Z
		  card-last-reviewed:: 2023-04-03T06:06:01.303Z
		  card-last-score:: 3
		  			#card #cloze
		- A {{cloze process}} is a unit of execution in concurrent programming.
		  			#card #cloze
		- A {{cloze thread}} is an execution unit that is part of a process, and a process can have {{cloze multiple threads}}.
		  			#card #cloze
		- {{cloze Multithreading}} is a technique that allows a CPU to execute multiple tasks of one process simultaneously while sharing resources.
		  			#card #cloze
		- {{cloze Hardware peripherals}} can add dedicated concurrent processing, with some examples being the watchdog timer, ADC, timers, communications with other devices, detecting external signal events, power management, etc.
		  card-last-interval:: 4
		  card-repeats:: 1
		  card-ease-factor:: 2.6
		  card-next-schedule:: 2023-04-07T06:03:23.122Z
		  card-last-reviewed:: 2023-04-03T06:03:23.122Z
		  card-last-score:: 5
		  			#card #cloze
		- {{cloze Interrupts}} are used by peripherals to notify the CPU of events.
		  			#card #cloze
		- {{cloze Simple systems}} are usually designed as foreground-background or super-loops, with foreground being called the interrupt level, and background being called the task level.
		  			#card #cloze
	- [[GPT Generated Flashcards]]
	  collapsed:: true
		- What is concurrency in computer science? #card
			- Concurrency is a property of systems in which several computations are executing simultaneously and potentially interacting with each other.
		- What is a process in concurrent programming? #card
		  card-last-interval:: -1
		  card-repeats:: 1
		  card-ease-factor:: 2.5
		  card-next-schedule:: 2023-04-03T22:00:00.000Z
		  card-last-reviewed:: 2023-04-03T06:14:48.695Z
		  card-last-score:: 1
			- A process is a unit of execution in concurrent programming.
		- What is a thread in concurrent programming? #card
			- A thread is an execution unit that is part of a process, and a process can have multiple threads.
		- What is multithreading? #card
			- Multithreading is a technique that allows a CPU to execute many tasks of one process at the same time.
		- What are hardware peripherals in a microcontroller unit for concurrency? #card
			- Hardware peripherals are components that add dedicated concurrent processing in a microcontroller unit.
		- What are some examples of hardware peripherals in a microcontroller unit for concurrency? #card
			- Examples of hardware peripherals include the watchdog timer, ADC, timers, communications with other devices, detecting external signal events, power management, among others.
		- How do peripherals in a microcontroller unit notify the CPU of events? #card
			- Peripherals use interrupts to notify the CPU of events.
		- What are super-loops in concurrency systems? #card
			- Super-loops are a way of designing concurrency systems, and they are usually categorized as foreground-background or task level.
- Scheduling
	- Event-triggered scheduling with interrupts relies on the CPUâ€™s hardware interrupt system to run the right code, adequate for simple systems
		- Interrupts provide a basic scheduling approach for CPU in an event-triggered approach
		- Basic architecture, useful for simple low-power devices
			- Very little code or time overhead
		- Uses built-in task dispatching of interrupt system
			- Can trigger ISRs with input changes, timer expiration, UART data reception, analog input level crossing comparator threshold
		- Function types
			- Main function configures system and then goes to sleep
			- If interrupted, it goes right back to sleep
		- Only interrupts are used for normal program operation
		- [[GPT Generated Flashcards]]
			- What is the approach used for event-triggered scheduling with interrupts? #card
				- The approach used for event-triggered scheduling with interrupts relies on the CPU's hardware interrupt system.
			- What does the basic architecture of event-triggered scheduling rely on? #card
			  card-last-interval:: -1
			  card-repeats:: 1
			  card-ease-factor:: 2.5
			  card-next-schedule:: 2023-04-03T22:00:00.000Z
			  card-last-reviewed:: 2023-04-03T06:08:33.354Z
			  card-last-score:: 1
				- The basic architecture of event-triggered scheduling with interrupts relies on **interrupts** as a basic scheduling approach for the CPU.
			- What type of devices is event-triggered scheduling with interrupts useful for? #card
			  card-last-interval:: 4
			  card-repeats:: 1
			  card-ease-factor:: 2.6
			  card-next-schedule:: 2023-04-07T06:04:08.042Z
			  card-last-reviewed:: 2023-04-03T06:04:08.042Z
			  card-last-score:: 5
				- Event-triggered scheduling with interrupts is useful for simple low-power devices.
			- What is the advantage of using event-triggered scheduling with interrupts? #card
				- Using event-triggered scheduling with interrupts results in very little code or time overhead.
			- What built-in task dispatching does event-triggered scheduling with interrupts use? #card
				- Event-triggered scheduling with interrupts uses the built-in task dispatching of the interrupt system.
			- What are some inputs that can trigger ISRs (Interrupt Service Routines) in event-triggered scheduling with interrupts? #card
				- Inputs such as input changes, timer expiration, UART (Universal Asynchronous Receiver/Transmitter) data reception, analog input level crossing comparator threshold can trigger ISRs in event-triggered scheduling with interrupts.
			- What is the function of the main function in event-triggered scheduling with interrupts? #card
				- The main function configures the system and then goes to sleep. If interrupted, it goes right back to sleep. Only interrupts are used for normal program operation.
	- Software scheduling of CPU time
		- Dynamic priority
			- It allows schedule to be computed on-the-fly
				- Based on importance
				- Prioritization means that less important tasks don't delay more important ones
			- How often do we decide what to run?
				- Coarse grain: After a task finishes. Also called Run-to-Completion (RTC) or non-preemptive dynamic scheduling.
					- Scheduler chooses among Ready tasks for execution based on priority
					- Scheduling Rules
						- If no task is running, scheduler starts the highest priority ready task
						- Once started, a task runs until it completes
						- Tasks then enter waiting state until triggered or released again
				- Fine grain: Any time. Called Preemptive, since one task can preempt another.
					- Advantages
						- Preemption offers best response time
						- It allows to do more processing (support more potholes, or higher vehicle speed)
					- Disadvantages
						- Requires more complicated programming, more memory
						- Introduces vulnerability to data race conditions
						- [[GPT Generated Flashcards]]
							- What is dynamic priority scheduling? #card
								- It is a type of scheduling that computes schedule on-the-fly based on task importance.
							- What is the difference between coarse grain scheduling and fine grain scheduling? #card
								- Coarse grain scheduling happens after a task finishes, while fine grain scheduling can happen anytime.
							- What are the advantages of preemptive scheduling? #card
								- Preemptive scheduling offers the best response time and can allow for more processing.
							- What are the disadvantages of preemptive scheduling? #card
								- Preemptive scheduling requires more complicated programming and more memory. It also introduces vulnerability to data race conditions.
							- What are the scheduling rules in dynamic priority scheduling? #card
								- If no task is running, the scheduler starts the highest priority ready task. Once a task starts, it runs until completion. It then enters waiting state until triggered or released again.
		- Static priority scheduling (Cyclic executive)
			- Advantage:
				- Very simple
			- Disadvantages:
				- Always run the same schedule, regardless of changing conditions and relative importance of tasks.
				- All tasks run at same rate. Changing rates requires adding extra calls to the function.
				- [[GPT Generated Flashcards]]
					- What is the advantage of Static priority scheduling (Cyclic executive)? #card
					  card-last-interval:: 4
					  card-repeats:: 1
					  card-ease-factor:: 2.6
					  card-next-schedule:: 2023-04-07T06:06:26.136Z
					  card-last-reviewed:: 2023-04-03T06:06:26.136Z
					  card-last-score:: 5
						- It is very simple.
					- What are the disadvantages of Static priority scheduling (Cyclic executive)? #card
						- 1. It always runs the same schedule, regardless of changing conditions and relative importance of tasks. 2. All tasks run at the same rate, and changing the rates requires adding extra calls to the function.
						- Maximum delay is sum of all task run times. Polling/execution rate is 1 /maximum delay.
	- Time definitions
		- Release time = Time at which task (or interrupt) requests service/is released/is ready to run
		- Latency time = Delay between release and start of service for task
		- Response time = Delay between request for service and completion of service for task
		- Task time = Time needed to perform computations for task
		- ISR time = Time needed to perform interrupt service routine
		- [[GPT Generated Flashcards]]
			- What is release time? #card
				- Release time is the time at which a task or interrupt requests service, is released, or is ready to run.
			- What is latency time? #card
				- Latency time is the delay between release and start of service for a task.
			- What is response time? #card
				- Response time is the delay between request for service and completion of service for a task.
			- What is ISR time? #card
				- ISR time is the time needed to perform interrupt service routine.
	- Common schedulers
		- Run-to-Completion Scheduler
			- Follows a "run-to-completion" model
				- A task's execution is not interrupted by any other task
				- Only ISRs can interrupt a task
				- After ISR completes, the previously-running task resumes
			- Priority is typically static, so can use a table with highest priority tasks first for a fast, simple scheduler implementation.
			- [[GPT Generated Flashcards]]
				- What model does the "Run-to-Completion Scheduler" follow? #card
					- It follows a "run-to-completion" model.
				- Is a task's execution interrupted by any other task in the "Run-to-Completion Scheduler"? #card
					- No, a task's execution is not interrupted by any other task.
				- What can interrupt a task in the "Run-to-Completion Scheduler"? #card
					- Only ISRs can interrupt a task.
				- What happens after an ISR completes in the "Run-to-Completion Scheduler"? #card
					- After an ISR completes, the previously-running task resumes.
				- What is the priority like in the "Run-to-Completion Scheduler"? #card
					- The priority is typically static, so a table with highest priority tasks first can be used for a fast, simple scheduler implementation.
		- Round Robin Scheduler
			- An example of cyclic and preemptive scheduler is the Round-Robin scheduler
			- It employs time-sharing and assigns to each process the same time slot or quantum.
			- It is a pre-emptive algorithm as the scheduler forces the process out of the CPU once the time quota expires.
			- [[GPT Generated Flashcards]]
				- What is an example of a cyclic and preemptive scheduler? #card
					- The Round-Robin scheduler.
				- What does the Round-Robin scheduler employ? #card
					- Time-sharing.
				- How does the Round-Robin scheduler assign time slots to processes? #card
					- It assigns each process the same time slot or quantum.
				- Is the Round-Robin scheduler a pre-emptive or non-preemptive algorithm? #card
					- It is a pre-emptive algorithm.
				- How does the Round-Robin scheduler handle processes that exceed their time quota? #card
				  card-last-interval:: -1
				  card-repeats:: 1
				  card-ease-factor:: 2.5
				  card-next-schedule:: 2023-04-03T22:00:00.000Z
				  card-last-reviewed:: 2023-04-03T06:12:48.910Z
				  card-last-score:: 1
					- The scheduler forces the process out of the CPU once the time quota expires.
- Real-time Operating Systems (RTOS)
	- A real-time system can calculate and guarantee the maximum response time for each task and interrupt service routine
	- The difference between "Soft" and "Hard" real-time systems is that the the latter have deadlines which must be met.
	- What does an RTOS provide?
		- Task Scheduler
			- Preemptive, prioritized to minimize response times
			- Interrupt support
		- Core Integrated RTOS services
			- Inter-process communication and synchronization (safe data sharing)
			- Time management
		- Optional Integrated RTOS services, for example:
			- I/O abstractions?
			- memory management?
			- File system?
			- networking support?
			- [[GPT Generated Flashcards]]
				- What is a real-time system? #card
					- A system that can calculate and guarantee the maximum response time for each task and interrupt service routine.
				- What is the difference between "Soft" and "Hard" real-time systems? #card
					- "Hard" real-time systems have deadlines which must be met, unlike "Soft" real-time systems.
				- What does an RTOS provide? #card
					- An RTOS provides a Task Scheduler, Preemptive, prioritized scheduling to minimize response times, Interrupt support, Core Integrated RTOS services, Inter-process communication and synchronization (safe data sharing), and Time management.
				- What are some Optional Integrated RTOS services? #card
					- Some Optional Integrated RTOS services are I/O abstractions, memory management, File system, and networking support.
- Embedded co-design guidelines
	- Approaches to Testing
		- Incremental Testing
			- Code a function and then test it (module/unit/element testing)
			- Test then a few working functions together (integration testing)
				- Continue enlarging the scope of tests as you write new functions
			- Incremental testing requires extra code for the test harness
				- A driver function calls the function to be tested
				- A stub function might be needed to simulate a function called by the function under test, and which returns or modifies data.
				- [[GPT Generated Flashcards]]
					- What is incremental testing? #card
						- Incremental testing is a testing process where a function is coded and tested, then integrated with other functions and tested as a group, with the scope of testing gradually increasing as new functions are added.
					- What types of testing are involved in incremental testing? #card
						- Module/unit/element testing and integration testing.
					- What is the purpose of a driver function in incremental testing? #card
						- The purpose of a driver function is to call the function being tested.
					- When might a stub function be needed in incremental testing? #card
						- A stub function might be needed to simulate a function that is called by the function under test, and which returns or modifies data.
					- Does incremental testing require extra code for the test harness? #card
						- Yes, incremental testing requires extra code for the test harness.
						- The test harness can automate the testing of individual functions to detect later bugs
		- Big Bang Testing
			- Code up all of the functions to create the system
			- Test the complete system
				- Plug and pray
		- Why Test Incrementally?
			- Finding out what failed is much easier
				- With Big Bang, since no function has been thoroughly tested, most probably have bugs
				- the question is "Which bug in which module causes the failure I see?"
				- Errors in one module can make it difficult to test another module
					- Errors in fundamental modules (e.g. kernel) can appear as bugs in other many other dependent modules
			- Clear root cause tracing: It's clear who made the mistake, and it's clear who needs to fix it
			- [[GPT Generated Flashcards]]
				- What is the advantage of testing incrementally? #card
					- Finding out what failed is much easier.
				- What is the disadvantage of using Big Bang testing? #card
				  card-last-interval:: -1
				  card-repeats:: 1
				  card-ease-factor:: 2.5
				  card-next-schedule:: 2023-04-03T22:00:00.000Z
				  card-last-reviewed:: 2023-04-03T06:14:57.214Z
				  card-last-score:: 1
					- Most probably have bugs because no function has been thoroughly tested.
				- What is the question that arises when bugs occur in the software? #card
					- Which bug in which module causes the failure I see?
				- How can errors in one module affect another module? #card
					- They can make it difficult to test another module.
				- How can errors in fundamental modules appear as bugs in many other dependent modules? #card
					- Errors in fundamental modules (e.g. kernel) can appear as bugs in many other dependent modules.
				- What is the advantage of clear root cause tracing? #card
					- It's clear who made the mistake and who needs to fix it.
				- What is the advantage of better automation? #card
					- Drivers and stubs initially require time to develop but save time for future testing.
			- Better automation: Drivers and stubs initially require time to develop, but save time for future testing